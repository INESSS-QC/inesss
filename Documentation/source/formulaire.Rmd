---
title: "Formulaire"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 2
  pdf_document:
    toc: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, results = "asis")
library(inesss)
library(kableExtra)
library(knitr)
```

[inesss v.`r as.character(packageVersion('inesss'))`](https://github.com/INESSS-QC/inesss1){target="_blank"}

# Connexion
Établir une connexion entre *R* et *Teradata*.

1. Inscrire le nom d'utilisateur (commence généralement par *MS*) ainsi que le mot de passe.
2. Cliquer sur le bouton *Connexion* pour établir la connexion.

**Attention : ** Si le mot de passe est expiré, une fenêtre demandant un nouveau mot de passe apparaîtra **en arrière plan**. Sélectionner cette fenêtre à partir de la barre des tâches, puis entrer le nouveau mot de passe.

### Exemple



```{r}
if (is_html_output()) {
  cat('<p style="page-break-before: always">')
  cat('<p style="margin-bottom:3cm">')
} else {
  cat("\\pagebreak")
}
```



# Requêtes via EXCEL
Exécution d'une ou plusieurs requêtes par l'intermédiaire d'un fichier EXCEL. Chaque onglet correspond à un tableau contenant les arguments d'une méthode.  
Pour éviter des erreurs de structure, il est conseillé d'utiliser les gabarits de chaque méthode disponibles à partir du fichier *Gabarits-formulaire.xlsx*.

1. Cliquer sur le bouton *Sélectionner fichier EXCEL* pour sélectionner le fichier EXCEL contenant la ou les requêtes.
2. Le programme vérifie si chaque onglet contient un tableau et si la structure de chaque colonne correspond à la méthode utilisée.
3. Si la structure est acceptée, le message `Aucune erreur, exécution possible.` s'affiche. Sinon, le message contient toutes les erreurs à corriger, regroupés par onglet.
4. Si la structure est acceptée, le bouton *Exécuter requêtes* apparaît. Ce bouton permet de sélectionner un répertoire et le nom du fichier à sauvegarder. Lorsque c'est fait, le programme exécute la requête associé aux arguments de chaque onglet. Un message en bas à droite indique que l'exécution est en cours et disparaît lorsque c'est terminé.
5. Le fichier sauvegarder présente les résultats de la manière suivante :
    + Les onglets possèdent le même nom que ceux du fichier initial contenant les arguments.
    + À gauche se trouve le tableau des résultats.
    + Au milieu, un tableau rappelant les arguments utilisés.
    + À droite, le code SQL de la première période d'analyse généré par les arguments et utilisé dans Teradata pour créer le tableau des résultats.










































